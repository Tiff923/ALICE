<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>React and Redux-Saga (Frontend) | opencerts-documentation</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="React and Redux-Saga (Frontend)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Documentations for opencerts" />
<meta property="og:description" content="Documentations for opencerts" />
<link rel="canonical" href="http://localhost:4000/react.html" />
<meta property="og:url" content="http://localhost:4000/react.html" />
<meta property="og:site_name" content="opencerts-documentation" />
<script type="application/ld+json">
{"headline":"React and Redux-Saga (Frontend)","url":"http://localhost:4000/react.html","description":"Documentations for opencerts","@type":"WebPage","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=6333f20af0df29ce3d2670f6792ee98f039418e8">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">opencerts-documentation</a></h1>
      

      <h1 id="react-and-redux-saga-frontend">React and Redux-Saga (Frontend)</h1>

<p><img src="/assets/react/React-logo.png" alt="React Logo" /></p>

<p><a href="https://redux-saga.js.org/"><code class="highlighter-rouge">redux-saga</code></a> is a library that aims to make application side effects (i.e. asynchronous things like data fetching and impure things like accessing the browser cache) easier to manage, more efficient to execute, easy to test, and better at handling failures.</p>

<h2 id="connecting-redux-store-to-react">Connecting Redux Store to React</h2>

<p><code class="highlighter-rouge">index.js</code></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create the saga middleware</span>
<span class="kd">const</span> <span class="nx">sagaMiddleware</span> <span class="o">=</span> <span class="nx">createSagaMiddleware</span><span class="p">();</span>
<span class="c1">// mount it on the Store</span>
<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">createStore</span><span class="p">(</span>
  <span class="nx">reducers</span><span class="p">,</span>
  <span class="nx">composeWithDevTools</span><span class="p">(</span><span class="nx">applyMiddleware</span><span class="p">(</span><span class="nx">sagaMiddleware</span><span class="p">))</span>
<span class="p">);</span>

<span class="nx">sagaMiddleware</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="nx">rootSaga</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="react-router-routing-the-application">React router (routing the application)</h2>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">BrowserRouter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">Switch</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/dashboard"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="sr">/Route</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/about"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">About</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/upload"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Upload</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/login"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Login</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/create"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">CreateAcc</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">PrivateRoute</span> <span class="nx">path</span><span class="o">=</span><span class="s2">"/test"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">testLogin</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">Redirect</span> <span class="k">from</span><span class="o">=</span><span class="s2">"/"</span> <span class="nx">to</span><span class="o">=</span><span class="s2">"/upload"</span> <span class="o">/&gt;</span> <span class="c1">// Redirect from / to /upload</span>
      <span class="o">&lt;</span><span class="sr">/Switch</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/BrowserRouter</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="sr">/Provider&gt;</span><span class="err">,
</span>  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'root'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<h2 id="redux-store">Redux Store</h2>

<p><code class="highlighter-rouge">reducers/editstate.js</code></p>

<h3 id="state">State</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">initialState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">corpusData</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="na">fileNames</span><span class="p">:</span> <span class="p">[],</span>
  <span class="na">layout</span><span class="p">:</span> <span class="p">{},</span>
  <span class="na">fileUploaded</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">uploadingData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">uploadStatus</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>

  <span class="na">updatingRelationData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">updatingNerData</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">nerSearch</span><span class="p">:</span> <span class="p">[</span><span class="k">new</span> <span class="nb">Set</span><span class="p">(),</span> <span class="kc">null</span><span class="p">],</span>

  <span class="na">documentId</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div></div>

<ul>
  <li>
    <p>corpusData</p>

    <ul>
      <li>Object containing the outputs from our ML models, with the keys being the fileNames</li>
      <li><code class="highlighter-rouge">corpusData = {'Overview': { 'ner' : ..., 'relation': ..., ... }, 'ChapterX': { 'ner' : ..., 'relation': ..., ... }, ...}</code></li>
    </ul>
  </li>
  <li>
    <p>fileNames</p>

    <ul>
      <li>Array of file names of type string</li>
      <li><code class="highlighter-rouge">fileNames = ['Overview', 'ChapterX', ...]</code></li>
    </ul>
  </li>
  <li>
    <p>layout</p>

    <ul>
      <li>Object containing the layouts for our dashboards, with the keys being the fileNames</li>
      <li>Initial layouts are taken from <code class="highlighter-rouge">utils/layout.js</code> and <code class="highlighter-rouge">utils/overviewLayout.js</code> (for Overview dashboard)</li>
    </ul>
  </li>
  <li>
    <p>fileUploaded</p>

    <ul>
      <li>Boolean that indicates whether a file has been uploaded.</li>
    </ul>
  </li>
  <li>
    <p>uploadingData</p>

    <ul>
      <li>Boolean that indicates whether the uploading process and ML model outputs are still ongoing.</li>
    </ul>
  </li>
  <li>
    <p>uploadStatus</p>

    <ul>
      <li>Either ‘SUCCESS’, ‘FAILURE’, or null</li>
      <li>Indicates the status of the upload process, initial value is null. ‘FAILURE’ redirects to <code class="highlighter-rouge">ErrorPage.js</code></li>
    </ul>
  </li>
  <li>
    <p>updatingRelationData</p>

    <ul>
      <li>Boolean that indiciates whether the relation data is still being updated when a relation is deleted or updated.</li>
    </ul>
  </li>
  <li>
    <p>updatingNerData</p>

    <ul>
      <li>Boolean that indiciates whether the NER data is still being updated when an entity is deleted or updated.</li>
    </ul>
  </li>
  <li>
    <p>nerSearch (Refer to <code class="highlighter-rouge">onSearchChange()</code> in <code class="highlighter-rouge">NerTable.js</code>)</p>

    <ul>
      <li>Initial value is <code class="highlighter-rouge">[new Set(), null]</code></li>
      <li>The first index is a set containing the searched entities found in the NER data.</li>
      <li>The second index is a string of the search that highlights the non-entity terms in <code class="highlighter-rouge">Taggy.js</code>.</li>
    </ul>
  </li>
  <li>
    <p>documentId</p>
    <ul>
      <li>The string that is the ObjectID of the document in the MongoDB database.</li>
    </ul>
  </li>
</ul>

<h3 id="actions-and-reducers">Actions and Reducers</h3>

<p>Actions are payloads of information that send data from the application to the Store.</p>

<p>Actions must have a type property that indicates the type of action being performed. Types should typically be defined as string constants.</p>

<p>The example below shows when the action creator <code class="highlighter-rouge">uploadingData</code> is called, the reducers’ case <code class="highlighter-rouge">types.UPLOADING_DATA</code> is executed and sets <code class="highlighter-rouge">uploadingData</code> and <code class="highlighter-rouge">fileUploaded</code> to <code class="highlighter-rouge">true</code>.</p>

<p>Actions:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">types</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">UPLOADING_DATA</span> <span class="p">:</span><span class="s1">'UPLOADING_DATA'</span><span class="p">,</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Reducers:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">reducer</span><span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">initialState</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">types</span><span class="p">.</span><span class="nx">UPLOADING_DATA</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">state</span><span class="p">,</span>
        <span class="na">uploadingData</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">fileUploaded</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="p">};</span>
    <span class="p">...</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div>

<p>Action Creators:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">function</span> <span class="nx">uploadingData</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="nx">types</span><span class="p">.</span><span class="nx">UPLOADING_DATA</span><span class="p">,</span>
    <span class="nx">payload</span><span class="p">,</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="selectors">Selectors</h3>

<p>Selectors are getters of the Store</p>

<p>E.g. The function <code class="highlighter-rouge">getFileStatus</code> returns the fileUploaded state from the Store.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">function</span> <span class="nx">getFileStatus</span><span class="p">(</span><span class="nx">store</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">store</span><span class="p">.</span><span class="nx">editstate</span><span class="p">.</span><span class="nx">fileUploaded</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="sagas">Sagas</h2>

<p><code class="highlighter-rouge">sagas/editstate.js</code></p>

<p>Taking the previous example further, after we upload data, we want to dispatch some action to notify the Store that the upload has succeeded and update the Store with the new data that was received.</p>

<p>In the example below, when the action creator <code class="highlighter-rouge">uploadingData</code> creates the action <code class="highlighter-rouge">types.UPLOADING_DATA</code>, <code class="highlighter-rouge">takeEvery(types.UPLOADING_DATA, uploadData)</code> watches for the action <code class="highlighter-rouge">UPLOADING_DATA</code> and calls the function <code class="highlighter-rouge">uploadData</code> concurrently.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="k">default</span> <span class="p">[</span>
  <span class="nx">takeEvery</span><span class="p">(</span><span class="nx">types</span><span class="p">.</span><span class="nx">UPLOADING_DATA</span><span class="p">,</span> <span class="nx">uploadData</span><span class="p">),</span>
  <span class="nx">takeEvery</span><span class="p">(</span><span class="nx">types</span><span class="p">.</span><span class="nx">UPDATING_NER_DATA</span><span class="p">,</span> <span class="nx">updateNer</span><span class="p">),</span>
  <span class="nx">takeEvery</span><span class="p">(</span><span class="nx">types</span><span class="p">.</span><span class="nx">UPDATING_RELATION_DATA</span><span class="p">,</span> <span class="nx">updateRelation</span><span class="p">),</span>
<span class="p">];</span>
</code></pre></div></div>

<p>In the function <code class="highlighter-rouge">uploadData</code> in <code class="highlighter-rouge">sagas/editstate.js</code>, <code class="highlighter-rouge">put</code> dispatches the action <code class="highlighter-rouge">UPLOAD_SUCCESS</code> to the Store, which sets the state of <code class="highlighter-rouge">uploadStatus</code> to ‘SUCCESS’ in the Store.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">yield</span> <span class="nx">put</span><span class="p">({</span>
      <span class="na">type</span><span class="p">:</span> <span class="nx">types</span><span class="p">.</span><span class="nx">UPLOAD_SUCCESS</span><span class="p">,</span>
    <span class="p">});</span>
</code></pre></div></div>

<h2 id="connecting-react-components-to-redux-saga">Connecting React Components to Redux-Saga</h2>

<p><code class="highlighter-rouge">App.js</code></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">connect</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'react-redux'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span>
  <span class="o">&lt;</span><span class="nx">reducers</span><span class="p">...</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">selectors</span><span class="p">...</span><span class="o">&gt;</span>
<span class="p">}</span> <span class="k">from</span> <span class="s1">'./reducers/editstate'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="nx">props</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span>
    <span class="nx">documentId</span><span class="p">,</span>
    <span class="nx">saveDocumentId</span><span class="p">,</span>
    <span class="p">...</span>
  <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">mapStateToProps</span> <span class="o">=</span> <span class="p">(</span><span class="nx">store</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">documentId</span><span class="p">:</span> <span class="nx">getDocumentId</span><span class="p">(</span><span class="nx">store</span><span class="p">),</span>
  <span class="p">...</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">mapDispatchToProps</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dispatch</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">saveDocumentId</span><span class="p">:</span> <span class="p">(</span><span class="nx">payload</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">dispatch</span><span class="p">(</span><span class="nx">saveDocumentId</span><span class="p">(</span><span class="nx">payload</span><span class="p">)),</span>
  <span class="p">...</span>
<span class="p">});</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">connect</span><span class="p">(</span><span class="nx">mapStateToProps</span><span class="p">,</span> <span class="nx">mapDispatchToProps</span><span class="p">)(</span><span class="nx">App</span><span class="p">);</span>
</code></pre></div></div>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
